//　rooms_controllerのshow_additionallyアクションが実行された後に、このファイルが実行される
// rooms_controllerで定義したインスタンス変数がここで使える

var messageContainer = document.getElementById("messages");

var messageHeight = messageContainer.scrollHeight
// 上からメッセージを追加
messageContainer.insertAdjacentHTML('afterbegin', "<%= j(render @messages) %>")
var newMessageHeight = messageContainer.scrollHeight
messageContainer.scrollBy(0, newMessageHeight - messageHeight)

// メッセージが存在するときだけ，更に読み込み可能とする
<% if @messages.present? %>
    showAdditionally = true
<% end %>